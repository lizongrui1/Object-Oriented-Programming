## 《面向对象是怎样工作的》   [日]平泽章

#### *1-4章：对于OOP的介绍*

类用于将变量和子程序汇总在一起，创建独立性高的构件；多态和继承用于重复代码，创建通用性强的构件。

**结构化编程问题**

1. 全局变量问题：

   全局变量可以被程序的任何位置使用，如果需要修改全局变量时，为了查明影响范围，就需要调查所有的逻辑。

2. 可重用性差：

   结构化语言中可重用的是子程序，通过重用既有程序可以一定程度上实现基本的处理，但是效果微不足道。

OOP正好可以解决上面的两个问题

1. OOP具有不使用全局变量的结构（封装）
2. OOP具有除公用子程序之外的可重用结构（继承、多态）



类有三种功能：

1. 汇总：能够将紧密联系的（多个）子程序和（多个）全局变量汇总到一个类中

   优点：构件的数量减少

   ​			方法（子程序）的命名变轻松

   ​			方法（子程序）变得容易查找

​    2.隐藏：能对其他类隐藏类中定义的变量和方法（子程序）

​	3.创建很多个：一旦定义了类，在运行时就可以由此创建很多个实例



进阶的OOP结构：

1.包：使用包来避免类名冲突

2.异常：就是一种返回特殊错误的结构

- 检查性异常：最具代表性的检查性异常是用户错误或问题引起的异常，这是程序员无法预见的。例如：要打开一个不存在的文件时，一个异常就发生了，这些异常在编译时不能被简单地忽略。—>测试
- 运行时异常：运行时异常是可能被程序员避免的异常。与检查性异常相反，运行时异常可以在编译时被忽略。

3.垃圾回收（GC）：将容易出错的内存释放处理由系统自动执行，而不是作为编程语言的语法提供



#### *第五章：理解内存结构：*

**存储实例的变量中存储的并不是实例本身，而是实例的指针。**

垃圾回收：发现孤立的实例就会进行垃圾回收，就是删除栈区和方法区无法到达的不需要的实例。



#### *第六章：OOP带来的软件重用和思想重用*

可重用构件群称为类库（因为OOP结构是以类为单位，所以称为类库）、框架或组件等...

设计模式从可重用构建群中提取思想、可重用构建群从设计模式进行创建，两者循环进行、相互促进。

①从类库中的类创建实例，汇总方法和变量定义进行使用（利用类）。

②将类库调用的逻辑替换为应用程序固有的处理（利用多态）。

③向类库中的类添加方法和变量定义，来创建新类（利用继承）。

**设计模式（GoF设计模式）：**不依赖于编程语言和应用程序的应用领域，对在各种情况下反复出现的类结构进行命名，形成模式。



#### *第七章：化为通用的归纳整理法的面向对象*

面向对象具有两个方面，即下游工程的“编程技术”和上游工程的“通用的归纳整理法”。

在编程之前，还需要进行业务分析和需求定义等工作。在系统开发的早期阶段进行的这些工作通常称为上游工程。在上游工程中，面向对象会提供两种基本结构：一种是集合论；另一种是职责分配。

**集合论：**就是因为OOP中实例是由类创建的，和集合论中的集合和元素非常相似，因此，类和实例在上游工程中会被应用于集合论。

**职责分配：**OOP中通过消息传递来实现职责分配的机制，使得程序的不同部分能够协同工作，每个对象都负责执行其特定的任务。



#### *第八章： UML：查看无形软件的工具*

①表示OOP程序的结构和动作、②表示归纳整理法的成果、③表示面向对象无法表示的信息。



#### *第九章：建模: 填补现实世界和软件之间的沟壑*

编程之前大致可以分为三个阶段：

1.业务分析：为什么使用计算机（why）

2.需求定义：让计算机干什么（what）

3.设计：软件如何实现（how）

所以建模的目的就是用计算机去通过分析考虑硬件性能、操作系统和中间件的特性以及编程语言的表现能力等去设计软件结构

#### *第十章：面向对象设计：拟人化和职责分配*

1.设计目标之一：去除重复

为了去除重复，传统编程语言提供的结构只有子程序（函数），用来实现步骤的公用化。而OOP中还提供了实现调用端公用化的多态、汇总类的共同部分的继承等结构。

2.设计目标之二：提高构件的独立性

将整体分割成多个子系统或构件（要提高独立性）组成的，为了提高可维护性和可重用性，重要的是使用独立性高的构件来组成软件。

**内聚度：**是评判软件构件所提供的功能互相结合的紧密程度的标准，结合得越紧密，内聚度越高，设计就越好。

**耦合度：**是评判多个软件构件之间互相依赖的程度的标准，依赖程度越低，耦合度越低，设计就越好。

在面向对象中，软件构件的基本单位是类，因此，内聚度高、耦合度低就相当于一个类中定义的功能（方法和变量）的含义密切相关，而类之间的交互较少。

提高构件独立性：比如起一个通俗理解的名字、只向外暴露需要使用的接口、创建的各个类和方法要尽可能地小（直接）

3.设计目标之三：避免依赖关系发生循环

依赖关系，就是某个构件使用其他构件。（不能像三角形那样A依赖B、B依赖C、C依赖A这样循环的）

*在OOP中，由于引入了汇总多个方法的类、汇总多个类的包等结构，类之间或者包之间容易出现依赖关系的循环，所以我们需要谨慎地设计包和类，避免依赖关系发生循环。*
